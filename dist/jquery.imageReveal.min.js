/*
 * jQuery Image Reveal - A Simple Before/After Image Viewer 
 *
 * Version: 0.0.1 
 * Date: July 18th, 2013 
 * Homepage: http://github.com/lemoncreative/jquery-image-reveal
 * Licence: MIT 
 * Copyright: (c) 2013 Lemon Creative; 
 */
!function(a){a.fn.extend({imageReveal:function(b){function c(a){a-=b.barWidth/2,a>b.paddingLeft&&a<=b.width-(b.paddingRight+b.barWidth)&&(f.drag.css({left:a}),f.overlay.width(a)),b.showCaption&&(a>b.width*b.captionChange?f.caption.text(f.before.attr("title")):f.caption.text(f.after.attr("title")))}function d(a){if(!e&&"click"!==a.type)return!1;var d;d=a.originalEvent&&a.originalEvent.changedTouches?a.originalEvent.changedTouches[0].pageX:a.pageX;var g=d-f.overlay.offset().left;return 0>g&&(g=0),g>b.width&&(g=b.width),c(g),!1}var e=!1,f={};return b=a.extend({barWidth:20,touchBarWidth:60,startPosition:50,paddingLeft:0,paddingRight:0,showCaption:!1,captionChange:.5,width:500,height:500},b),("ontouchstart"in window||"onmsgesturechange"in window)&&(b.barWidth=b.touchBarWidth),b.startPosition>b.width-b.barWidth?b.startPosition=b.width-b.barWidth:b.startPosition<0&&(b.startPosition=0),b.captionChange>1?b.captionChange=1:b.captionChange<0&&(b.captionChange=0),this.each(function(){f.container=a(this).addClass("imageReveal"),f.before=f.container.children("img").first().width(b.width).height(b.height).hide(),f.after=f.before.next().width(b.width).height(b.height).hide(),f.container.width(b.width).height(b.height).css({overflow:"hidden",position:"relative"}).append('<div class="imageReveal-overlay"></div>').append('<div class="imageReveal-background"></div>').append('<div class="imageReveal-drag"></div>').append('<div class="imageReveal-caption">'+f.before.attr("title")+"</div>"),f.bg=f.container.children(".imageReveal-background").width(b.width).height(b.height).css({"background-image":"url("+f.after.attr("src")+")","background-size":b.width+"px "+b.height+"px"}),f.caption=b.showCaption?f.container.children(".imageReveal-caption").show():f.container.children(".imageReveal-caption").hide(),f.overlay=f.container.children(".imageReveal-overlay").width(b.width).height(b.height).css({"background-image":"url("+f.before.attr("src")+")","background-size":b.width+"px "+b.height+"px"}).animate({width:b.width-b.startPosition-b.barWidth}),f.drag=f.container.children(".imageReveal-drag").width(b.barWidth).height(b.height).animate({right:b.startPosition}).on("mousedown touchstart",function(){return e=!0,f.drag.addClass("dragging"),!1}).on("mouseup touchend touchcancel",function(){return e=!1,f.drag.removeClass("dragging"),!1}),a(document).mouseup(function(){e&&(e=!1,f.drag.removeClass("dragging"))})}).on("mousemove click touchmove",d)}})}(jQuery);
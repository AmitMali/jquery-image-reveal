/*
 * jQuery Image Reveal - A Simple Before/After Image Viewer 
 *
 * Version: 0.0.2 
 * Date: July 18th, 2013 
 * Homepage: http://github.com/lemoncreative/jquery-image-reveal
 * Licence: MIT 
 * Copyright: (c) 2013 Lemon Creative; 
 */
!function(a){a.fn.extend({imageReveal:function(b){function c(a,c){a-=b.barWidth/2,a>b.paddingLeft&&a<=b.width-(b.paddingRight+b.barWidth)&&(f[c].drag.css({left:a}),f[c].overlay.width(a)),b.showCaption&&(a>b.width*b.captionChange?f[c].caption.text(f[c].before.attr("title")):f[c].caption.text(f[c].after.attr("title")))}function d(d){var g=a(this).data("imageRevealID");if(!e&&"click"!==d.type)return!1;var h;h=d.originalEvent&&d.originalEvent.changedTouches?d.originalEvent.changedTouches[0].pageX:d.pageX;var i=h-f[g].overlay.offset().left;return 0>i&&(i=0),i>b.width&&(i=b.width),c(i,g),!1}var e=!1,f={};return b=a.extend({barWidth:20,touchBarWidth:60,startPosition:50,paddingLeft:0,paddingRight:0,showCaption:!1,captionChange:.5,width:500,height:500},b),("ontouchstart"in window||"onmsgesturechange"in window)&&(b.barWidth=b.touchBarWidth),b.startPosition>b.width-b.barWidth?b.startPosition=b.width-b.barWidth:b.startPosition<0&&(b.startPosition=0),b.captionChange>1?b.captionChange=1:b.captionChange<0&&(b.captionChange=0),this.each(function(c){f[c]={},f[c].container=a(this).addClass("imageReveal").data("imageRevealID",c),f[c].before=f[c].container.children("img").first().width(b.width).height(b.height).hide(),f[c].after=f[c].before.next().width(b.width).height(b.height).hide(),f[c].container.width(b.width).height(b.height).css({overflow:"hidden",position:"relative"}).append('<div class="imageReveal-overlay"></div>').append('<div class="imageReveal-background"></div>').append('<div class="imageReveal-drag"></div>').append('<div class="imageReveal-caption">'+f[c].before.attr("title")+"</div>"),f[c].bg=f[c].container.children(".imageReveal-background").width(b.width).height(b.height).css({"background-image":"url("+f[c].after.attr("src")+")","background-size":b.width+"px "+b.height+"px"}),f[c].caption=b.showCaption?f[c].container.children(".imageReveal-caption").show():f[c].container.children(".imageReveal-caption").hide(),f[c].overlay=f[c].container.children(".imageReveal-overlay").width(b.width).height(b.height).css({"background-image":"url("+f[c].before.attr("src")+")","background-size":b.width+"px "+b.height+"px"}).animate({width:b.width-b.startPosition-b.barWidth}),f[c].drag=f[c].container.children(".imageReveal-drag").width(b.barWidth).height(b.height).animate({right:b.startPosition}).on("mousedown touchstart",function(){return e=!0,f[c].drag.addClass("dragging"),!1}).on("mouseup touchend touchcancel",function(){return e=!1,f[c].drag.removeClass("dragging"),!1}),a(document).mouseup(function(){e&&(e=!1,f[c].drag.removeClass("dragging"))})}).on("mousemove click touchmove",d)}})}(jQuery);